---
# ============================================
# Playbook Zabbix - zabbix.yml
# DÃ©ploiement du serveur et des agents Zabbix
# ============================================

- name: "Installation du serveur Zabbix"
  hosts: zabbix_servers
  become: yes
  roles:
    - role: zabbix-server
      tags: [zabbix, server, monitoring]

- name: "Installation des agents Zabbix"
  hosts: zabbix_agents
  become: yes
  roles:
    - role: zabbix-agent
      tags: [zabbix, agent, monitoring]

- name: "VÃ©rification de Zabbix"
  hosts: zabbix_servers
  become: yes
  tasks:
    - name: VÃ©rifier que Zabbix Server est accessible
      uri:
        url: "http://localhost/zabbix"
        status_code: 200
      register: zabbix_test
      ignore_errors: yes

    - name: Afficher le rÃ©sumÃ© Zabbix
      debug:
        msg: |
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          ZABBIX DÃ‰PLOYÃ‰ AVEC SUCCÃˆS
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ğŸ“Š Serveur Zabbix:
             - URL: http://{{ ansible_host }}/zabbix
             - Status: {{ 'OK' if zabbix_test.status == 200 else 'En cours de dÃ©marrage' }}
          
          ğŸ”‘ Identifiants par dÃ©faut:
             - Utilisateur: Admin
             - Mot de passe: zabbix
          
          ğŸ“¡ Agents installÃ©s sur:
             - node01 (192.168.56.11)
             - node02 (192.168.56.12)
          
          ğŸ“ˆ MÃ©triques disponibles:
             - CPU / RAM / Disque
             - Ã‰tat du cluster
             - Status Nginx
             - Status Samba
          
          âš ï¸  N'oubliez pas de changer le mot de passe par dÃ©faut !
          
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
